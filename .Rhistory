knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library("ggplot2")
library("OrgMassSpecR")
source('~/GitHub/PRoteinMassSpecSim/Functions.R')
source("Functions.R")
proteinSequence <- "MAASTASHRPIKGILKNKTSTTSSMVASAEQPRGNVDEELSKKSQKWDEMNILATYHPADKDYGLMKIDEPSTPYHSMMGDDEDACSDTEATEAMAPDILARKLAAAEGLEPKYRIQEQESSGEEDSDLSPEEREKKRQFEMKRKLHYNEGLNIKLARQLISKDLHDDDEDEEMLETADGESMNTEESNQGSTPSDQQQNKLRSS"
proteinSequence <- "MAASTASHRPIKGILKNKTSTTSSMVASAEQPRGNVDEELSKKSQKWDEMNILATYHPADKDYGLMKIDEPSTPYHSMMGDDEDACSDTEATEAMAPDILARKLAAAEGLEPKYRIQEQESSGEEDSDLSPEEREKKRQFEMKRKLHYNEGLNIKLARQLISKDLHDDDEDEEMLETADGESMNTEESNQGSTPSDQQQNKLRSS"
proteinChemForm <- pepToForm(proteinSequence)
MonoisotopicMass(proteinChemForm)
list(C = 2)
source('~/GitHub/PRoteinMassSpecSim/Functions.R')
proteinChemForm <- pepToForm(proteinSequence, output = "list")
MonoisotopicMass(proteinChemForm)
MonoisotopicMass
source("https://bioconductor.org/biocLite.R")
biocLite("UniProt.ws")
library(UniProt.ws)
up <- UniProt.ws(taxId=9606)
up
keytypes(up)
columns(up)
keytypes(up)
proteinSequence <- select(up, proteinAccession, "SEQUENCE", "UNIPROTKB")
proteinAccession <- "P41236"
proteinSequence <- select(up, proteinAccession, "SEQUENCE", "UNIPROTKB")
proteinSequence <- select(up, proteinAccession, "SEQUENCE", "UNIPROTKB")[2]
proteinChemForm <- pepToForm(proteinSequence, output = "list")
View(proteinSequence)
proteinSequence <- select(up, proteinAccession, "SEQUENCE", "UNIPROTKB")
proteinSequence <- select(up, proteinAccession, "SEQUENCE", "UNIPROTKB")[2]
proteinChemForm <- pepToForm(proteinSequence[1], output = "list")
proteinSequence[1]
proteinChemForm <- pepToForm(as.vector(proteinSequence), output = "list")
proteinSequence <- select(up, proteinAccession, "SEQUENCE", "UNIPROTKB")[2]
proteinSequence
proteinSequence <- as.vector(select(up, proteinAccession, "SEQUENCE", "UNIPROTKB")[2])
proteinSequence <- as.vector(select(up, proteinAccession, "SEQUENCE", "UNIPROTKB")[2])
proteinSequence
proteinSequence <- as.vector(select(up, proteinAccession, "SEQUENCE", "UNIPROTKB")[2,1])
proteinSequence
proteinSequence <- as.vector(select(up, proteinAccession, "SEQUENCE", "UNIPROTKB")[2,2])
proteinSequence
proteinSequence <- as.vector(select(up, proteinAccession, "SEQUENCE", "UNIPROTKB")[2])
proteinSequence <- select(up, proteinAccession, "SEQUENCE", "UNIPROTKB")
proteinSequence
up <- UniProt.ws(taxId=9606)
View(proteinSequence)
proteinSequence[2]
proteinSequence[2,1]
proteinSequence[1]
proteinSequence[,1]
proteinSequence[,2]
proteinSequence <- select(up, proteinAccession, "SEQUENCE", "UNIPROTKB")[,2]
proteinChemForm <- pepToForm(proteinSequence, output = "list")
MonoisotopicMass(proteinChemForm)
dist <- IsotopicDistribution(proteinChemForm)
View(dist)
isotopeDist <- IsotopicDistribution(proteinChemForm)
ggplot(isotopeDist, aes(mz, percent)) + geom_vline()
ggplot(isotopeDist, aes(mz, percent)) + geom_vline( xintercept = 0)
ggplot(isotopeDist, aes(mz, percent)) + geom_point()
?geom_vline
ggplot(isotopeDist, aes(mz, percent)) + geom_line()
ggplot(isotopeDist, aes(mz, ymin = 0, ymax = percent)) + geom_linerange()
View(dist)
isotopeDist_ch20 <- isotopeDist
isotopeDist_ch20$mz <- isotopeDist_ch20$mz + 1 / 20
ggplot(isotopeDist, aes(mz, ymin = 0, ymax = percent)) + geom_linerange()
ggplot(isotopeDist_ch20, aes(mz, ymin = 0, ymax = percent)) + geom_linerange()
isotopeDist_ch20$mz + 1 / 20
(isotopeDist_ch20$mz + 1)
(isotopeDist_ch20$mz + 1) / 20
isotopeDist_ch20$mz <- (isotopeDist_ch20$mz + 1) / 20
ggplot(isotopeDist_ch20, aes(mz, ymin = 0, ymax = percent)) + geom_linerange()
rep(isotopeDist)
isotopeDist_ch <- rbind(rep(isotopeDist,5))
rep(isotopeDist,5)
isotopeDist_ch <- rbind(unlist(rep(isotopeDist,5)))
View(isotopeDist_ch)
charges <- 25:10
IsotopicDistribution
Hydrogen = 1.0078250321
remove(isotopeDist_ch)
isotopeDist_ch <- NULL
for (i in length(charges)){
tmp <- isotopeDist
tmp$z <- charges[i]
tmp$mz <- ( tmp$mz + (Hydrogen * tmp$z))  / tmp$z
isotopeDist_ch <- rbind(isotopeDist_ch, tmp)
}
View(isotopeDist_ch)
charges <- 25:10
Hydrogen = 1.0078250321
isotopeDist_ch <- NULL
length(charges)
for (i in length(charges)){
tmp <- isotopeDist
tmp$z <- charges[i]
tmp$mz <- ( tmp$mz + (Hydrogen * tmp$z))  / tmp$z
isotopeDist_ch <- rbind(isotopeDist_ch, tmp)
}
View(isotopeDist_ch)
ggplot(isotopeDist_ch, aes(mz, ymin = 0, ymax = percent)) + geom_linerange()
ggplot(isotopeDist_ch, aes(mz, ymin = 0, ymax = percent)) + geom_linerange()
for (i in length(charges)){
tmp <- isotopeDist
tmp$z <- charges[i]
tmp$mz <- ( tmp$mz + (Hydrogen * tmp$z))  / tmp$z
isotopeDist_ch <- rbind(isotopeDist_ch, tmp)
ggplot(isotopeDist_ch, aes(mz, ymin = 0, ymax = percent)) + geom_linerange()
}
View(isotopeDist_ch)
charges <- 25:10
Hydrogen = 1.0078250321
isotopeDist_ch <- NULL
isotopeDist_ch <- NULL
charges <- 25:10
Hydrogen = 1.0078250321
isotopeDist_ch <- NULL
tmp <- isotopeDist
tmp$z <- charges[i]
tmp$mz <- ( tmp$mz + (Hydrogen * tmp$z))  / tmp$z
View(tmp)
isotopeDist_ch <- rbind(isotopeDist_ch, tmp)
i = 1
tmp <- isotopeDist
tmp$z <- charges[i]
tmp$mz <- ( tmp$mz + (Hydrogen * tmp$z))  / tmp$z
isotopeDist_ch <- rbind(isotopeDist_ch, tmp)
View(isotopeDist_ch)
ggplot(isotopeDist_ch, aes(mz, ymin = 0, ymax = percent)) + geom_linerange()
charges <- 25:10
Hydrogen = 1.0078250321
isotopeDist_ch <- NULL
for (i in length(charges)){
tmp <- isotopeDist
tmp$z <- charges[i]
tmp$mz <- ( tmp$mz + (Hydrogen * tmp$z))  / tmp$z
isotopeDist_ch <- rbind(isotopeDist_ch, tmp)
}
isotopeDist_ch <- isotopeDist
for (i in length(charges)){
tmp <- isotopeDist
tmp$z <- charges[i]
tmp$mz <- ( tmp$mz + (Hydrogen * tmp$z))  / tmp$z
isotopeDist_ch <- rbind(isotopeDist_ch, tmp)
}
for (i in length(charges)){
tmp <- isotopeDist
tmp$z <- charges[i]
tmp$mz <- ( tmp$mz + (Hydrogen * tmp$z))  / tmp$z
if (i == 1){isotopeDist_ch <- tmp}
else isotopeDist_ch <- rbind(isotopeDist_ch, tmp)
}
remove(isotopeDist_ch)
for (i in length(charges)){
tmp <- isotopeDist
tmp$z <- charges[i]
tmp$mz <- ( tmp$mz + (Hydrogen * tmp$z))  / tmp$z
if (i == 1){isotopeDist_ch <- tmp}
else isotopeDist_ch <- rbind(isotopeDist_ch, tmp)
}
isotopeDist_ch <- tmp
remove(isotopeDist_ch)
for (i in length(charges)){
tmp <- isotopeDist
tmp$z <- charges[i]
tmp$mz <- ( tmp$mz + (Hydrogen * tmp$z))  / tmp$z
if (i == 1){isotopeDist_ch <- tmp}
else isotopeDist_ch <- rbind(isotopeDist_ch, tmp)
}
remove(isotopeDist_ch)
for (i in length(charges)){
tmp <- isotopeDist
tmp$z <- charges[i]
tmp$mz <- ( tmp$mz + (Hydrogen * tmp$z))  / tmp$z
if (i == 1){isotopeDist_ch <- tmp}
else {isotopeDist_ch <- rbind(isotopeDist_ch, tmp)}
}
up <- UniProt.ws(taxId=9606)
up
keytypes(up)
columns(up)
proteinAccession <- "P41236"
proteinSequence <- select(up, proteinAccession, "SEQUENCE", "UNIPROTKB")[,2]
proteinChemForm <- pepToForm(proteinSequence, output = "list")
source("Functions.R")
proteinChemForm <- pepToForm(proteinSequence, output = "list")
MonoisotopicMass(proteinChemForm)
isotopeDist <- IsotopicDistribution(proteinChemForm)
ggplot(isotopeDist, aes(mz, percent)) + geom_point()
ggplot(isotopeDist, aes(mz, ymin = 0, ymax = percent)) + geom_linerange()
charges <- 25:10
Hydrogen = 1.0078250321
remove(isotopeDist_ch)
for (i in length(charges)){
tmp <- isotopeDist
tmp$z <- charges[i]
tmp$mz <- ( tmp$mz + (Hydrogen * tmp$z))  / tmp$z
if (i == 1){isotopeDist_ch <- tmp}
else {isotopeDist_ch <- rbind(isotopeDist_ch, tmp)}
}
View(tmp)
charges <- 25:10
Hydrogen = 1.0078250321
remove(isotopeDist_ch)
for (z in charges){
tmp <- isotopeDist
tmp$z <- z
tmp$mz <- ( tmp$mz + (Hydrogen * z))  / z
if ( z == charges[1]){isotopeDist_ch <- tmp}
else {isotopeDist_ch <- rbind(isotopeDist_ch, tmp)}
}
ggplot(isotopeDist_ch, aes(mz, ymin = 0, ymax = percent)) + geom_linerange()
charges <- 25:20
Hydrogen = 1.0078250321
remove(isotopeDist_ch)
for (z in charges){
tmp <- isotopeDist
tmp$z <- z
tmp$mz <- ( tmp$mz + (Hydrogen * z))  / z
if ( z == charges[1]){isotopeDist_ch <- tmp}
else {isotopeDist_ch <- rbind(isotopeDist_ch, tmp)}
}
ggplot(isotopeDist_ch, aes(mz, ymin = 0, ymax = percent)) + geom_linerange()
charges <- 40:25
Hydrogen = 1.0078250321
remove(isotopeDist_ch)
for (z in charges){
tmp <- isotopeDist
tmp$z <- z
tmp$mz <- ( tmp$mz + (Hydrogen * z))  / z
if ( z == charges[1]){isotopeDist_ch <- tmp}
else {isotopeDist_ch <- rbind(isotopeDist_ch, tmp)}
}
ggplot(isotopeDist_ch, aes(mz, ymin = 0, ymax = percent)) + geom_linerange()
charges <- 40:45
Hydrogen = 1.0078250321
remove(isotopeDist_ch)
for (z in charges){
tmp <- isotopeDist
tmp$z <- z
tmp$mz <- ( tmp$mz + (Hydrogen * z))  / z
if ( z == charges[1]){isotopeDist_ch <- tmp}
else {isotopeDist_ch <- rbind(isotopeDist_ch, tmp)}
}
ggplot(isotopeDist_ch, aes(mz, ymin = 0, ymax = percent)) + geom_linerange()
charges <- 45
Hydrogen = 1.0078250321
remove(isotopeDist_ch)
for (z in charges){
tmp <- isotopeDist
tmp$z <- z
tmp$mz <- ( tmp$mz + (Hydrogen * z))  / z
if ( z == charges[1]){isotopeDist_ch <- tmp}
else {isotopeDist_ch <- rbind(isotopeDist_ch, tmp)}
}
ggplot(isotopeDist_ch, aes(mz, ymin = 0, ymax = percent)) + geom_linerange()
ggplot(isotopeDist_ch, aes(mz, ymin = 0, ymax = -percent)) + geom_linerange()
ggplot(isotopeDist_ch, aes(mz, ymin = 0, ymax = -percent, coulour = "red")) + geom_linerange()
ggplot(isotopeDist_ch, aes(mz, ymin = 0, ymax = -percent, colour = "red")) + geom_linerange()
ggplot(isotopeDist_ch, aes(mz, ymin = 0, ymax = percent, colour = "red")) + geom_linerange()
IsotopicDistribution
sample(c(12, 13.0033548378), size = 20,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107))
sum(sample(c(12, 13.0033548378), size = 50,
replace = TRUE, prob = c(0.9893, 0.0107)))
sum(sample(c(12, 13.0033548378), size = 10,
replace = TRUE, prob = c(0.9893, 0.0107)))
sum(sample(c(12, 13.0033548378), size = 10,
replace = TRUE, prob = c(0.9893, 0.0107)))
sum(sample(c(12, 13.0033548378), size = 10,
replace = TRUE, prob = c(0.9893, 0.0107)))
sum(sample(c(12, 13.0033548378), size = 10,
replace = TRUE, prob = c(0.9893, 0.0107)))
sum(sample(c(12, 13.0033548378), size = 10,
replace = TRUE, prob = c(0.9893, 0.0107)))
sum(sample(c(12, 13.0033548378), size = 10,
replace = TRUE, prob = c(0.9893, 0.0107)))
sum(sample(c(12, 13.0033548378), size = 10,
replace = TRUE, prob = c(0.9893, 0.0107)))
sum(sample(c(12, 13.0033548378), size = 10,
replace = TRUE, prob = c(0.9893, 0.0107)))
sum(sample(c(12, 13.0033548378), size = 10,
replace = TRUE, prob = c(0.9893, 0.0107)))
sum(sample(c(12, 13.0033548378), size = 10,
replace = TRUE, prob = c(0.9893, 0.0107)))
sum(sample(c(12, 13.0033548378), size = 10,
replace = TRUE, prob = c(0.9893, 0.0107)))
sum(sample(c(12, 13.0033548378), size = 10,
replace = TRUE, prob = c(0.9893, 0.0107)))
sum(sample(c(12, 13.0033548378), size = 10,
replace = TRUE, prob = c(0.9893, 0.0107)))
sum(sample(c(12, 13.0033548378), size = 10,
replace = TRUE, prob = c(0.9893, 0.0107)))
aspirin <- IsotopicDistribution( list(C = 9, H = 8, O = 4))
ggplot(aspirin, aes(mz, ymin = 0, ymax = percent, colour = "red")) + geom_linerange()
View(aspirin)
